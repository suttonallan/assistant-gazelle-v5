# Centenant Configuration - Assistant Gazelle V5
# Règles et conventions à retenir pour le projet

## RÈGLE #1: Distinction Client vs Contact (CRITIQUE)
# Ne JAMAIS confondre:
# - CONTACT = Personne physique rencontrée sur place
# - CLIENT = Entité qui paie la facture
#
# Priorité ABSOLUE au CONTACT dans l'interface utilisateur
# Codes d'accès TOUJOURS liés à l'adresse physique, JAMAIS au client
#
# Voir: docs/DISTINCTION_CLIENT_CONTACT.md

## RÈGLE #2: Mapping Géographique
# Utiliser api/chat/geo_mapping.py pour transformer codes postaux
# Priorité: Quartier spécifique > Ville générique
# Ex: H2G → "Rosemont" (pas "Montréal")
#
# Voir: api/chat/geo_mapping.py

## RÈGLE #3: Bridge V5/V6
# Toujours isoler la logique de transformation dans le DataProvider
# Le frontend et les routes NE DOIVENT PAS changer lors de la migration V6
# Pattern: Strategy Pattern avec V5DataProvider / V6DataProvider
#
# Voir: api/chat/service.py

## RÈGLE #4: Mobile-First Design
# Interface Chat optimisée pour mobile
# Niveau 1 (Cards): Info critique uniquement
# Niveau 2 (Drawer): Détails accessibles mais pas intrusifs
#
# Voir: frontend/src/components/ChatIntelligent.jsx

## RÈGLE #5: Tests d'Intégration
# TOUJOURS tester les 3 endpoints après modification:
# - POST /api/chat/query
# - GET /api/chat/day/{date}
# - GET /api/chat/appointment/{id}
#
# Lancer: python3 test_chat_integration.py

## RÈGLE #6: Sécurité Codes d'Accès
# Les codes d'accès sont des données SENSIBLES
# - Liés à l'adresse physique (location), jamais au client
# - Affichés uniquement dans le Drawer détails (Niveau 2)
# - Font monospace, couleur distinctive (orange)
# - Jamais dans les logs ou traces
#
# Exemple correct:
#   location = get_location(appointment.location_id)
#   access_code = location.access_code  # ✅ Bon
#
# Exemple incorrect:
#   client = get_client(appointment.client_id)
#   access_code = client.access_code  # ❌ Mauvais (siège social)

## RÈGLE #7: Variables d'Environnement Vite
# Vite utilise import.meta.env (PAS process.env)
# Prefix obligatoire: VITE_
#
# Exemple correct:
#   const API_BASE = import.meta.env.VITE_API_URL  # ✅ Bon
#
# Exemple incorrect:
#   const API_BASE = process.env.REACT_APP_API_URL  # ❌ Mauvais (Create React App)
#
# Variables standard:
#   import.meta.env.MODE    // 'development' ou 'production'
#   import.meta.env.DEV     // true en dev
#   import.meta.env.PROD    // true en production
